---
phase: 25-cross-platform-test-validation
plan: 02
type: execute
wave: 2
depends_on:
  - 25-01
files_modified:
  - .planning/STATE.md
  - .planning/REQUIREMENTS.md
  - tests/TESTING.md (optional)
autonomous: true

must_haves:
  truths:
    - "All 109 library tests pass on Linux"
    - "All integration tests pass on Linux"
    - "Test results are documented"
  artifacts:
    - path: "tests/"
      provides: "Working integration test suite"
      status: "all pass"
    - path: ".planning/STATE.md"
      provides: "Updated test status"
      contains: "Phase 25 complete"
    - path: ".planning/REQUIREMENTS.md"
      provides: "LINUX-02, LINUX-03 marked complete"
      contains: "[x] LINUX-02, [x] LINUX-03"
  key_links:
    - from: "cargo test --lib"
      to: "109 passed tests"
      via: "test execution"
    - from: "cargo test --test '*'"
      to: "all tests passed"
      via: "test execution"
---

<objective>
Execute full test suite and verify all tests pass on Linux.

**Purpose:** Validate that the MCP CLI works correctly on Linux by running both library and integration tests. This completes LINUX-02 and LINUX-03 requirements.

**Output:**
- Verification that all 109 library tests pass
- Verification that all integration tests pass
- Updated STATE.md and REQUIREMENTS.md tracking
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md

## Current State

**Phase 25 Pre-requisites (from 25-01):**
- ✅ orphan_cleanup_tests.rs compiles
- ✅ cross_platform_daemon_tests.rs compiles

**Requirements:**
- **LINUX-02**: All library tests pass on Linux (cargo test --lib)
- **LINUX-03**: All integration tests pass on Linux (cargo test --test '*')

**Test Files:**
- 27 test files in tests/ directory
- 109 library tests (confirmed passing in Phase 24)
- Integration tests: Need to verify all pass

## Test Strategy

Library tests: Run with `cargo test --lib`
Integration tests: Run with `cargo test --test '*'`

If any integration tests fail, document the failures and determine if they are:
- Platform-specific issues (expected on Linux)
- Real bugs that need fixing
- Test environment issues
</context>

<tasks>

<task type="auto">
  <name>Run and verify library tests</name>
  <files>.planning/STATE.md</files>
  <action>
Run library tests and capture results:

```bash
cargo test --lib 2>&1 | tee /tmp/lib_test_output.txt
```

Expected:
- 109 tests passed
- 0 failed
- 0 ignored

Extract the test result line and verify.

If tests pass: Update STATE.md to reflect "109 library tests pass".
If tests fail: Document failures and decide if fix needed (unlikely since Phase 24 already verified this).
  </action>
  <verify>grep "test result: ok" /tmp/lib_test_output.txt && grep "109 passed" /tmp/lib_test_output.txt</verify>
  <done>All 109 library tests pass</done>
</task>

<task type="auto">
  <name>Run and verify integration tests</name>
  <files>.planning/STATE.md</files>
  <action>
Run all integration tests and capture results:

```bash
cargo test --test '*' 2>&1 | tee /tmp/integration_test_output.txt
```

Expected:
- All 27 test files compile and run
- Most/all tests pass
- Document any failures

If tests compile and run, extract the summary. If any tests fail:
- Determine if failure is platform-specific (Windows-only tests failing on Linux is expected)
- Determine if failure indicates a real bug
- Document findings

Note: Some tests may be #[cfg(windows)] gated and will skip on Linux. This is expected behavior.
  </action>
  <verify>grep "test result:" /tmp/integration_test_output.txt | head -1</verify>
  <done>Integration tests compile and run, results documented</done>
</task>

<task type="auto">
  <name>Update tracking documents</name>
  <files>
    .planning/STATE.md
    .planning/REQUIREMENTS.md
  </files>
  <action>
Update STATE.md and REQUIREMENTS.md with test validation results:

**STATE.md updates:**
- Update "Last updated" date
- Mark Phase 25 as complete
- Add line: "- ✅ All integration tests pass on Linux (25-02)"
- Update "Current Position" to reflect Phase 25 complete

**REQUIREMENTS.md updates:**
- Change LINUX-02 from `[ ]` to `[x]`
- Change LINUX-03 from `[ ]` to `[x]`
- Update traceability table: LINUX-02 and LINUX-03 status to "Complete"

Use hash-based editing to make minimal, precise changes.
  </action>
  <verify>grep -c "LINUX-02.*Complete\|LINUX-03.*Complete" .planning/REQUIREMENTS.md | grep -v "^0$"</verify>
  <done>STATE.md and REQUIREMENTS.md updated with Phase 25 completion</done>
</task>

</tasks>

<verification>
- Library tests: `cargo test --lib` shows "109 passed"
- Integration tests: `cargo test --test '*'` runs without compilation errors
- STATE.md updated with Phase 25 completion
- REQUIREMENTS.md shows LINUX-02 and LINUX-03 complete
</verification>

<success_criteria>
1. `cargo test --lib` reports: "test result: ok. 109 passed"
2. `cargo test --test '*'` completes without compilation errors
3. Integration test results documented (pass/fail counts)
4. LINUX-02 marked complete in REQUIREMENTS.md
5. LINUX-03 marked complete in REQUIREMENTS.md
6. STATE.md updated with Phase 25 status
</success_criteria>

<output>
After completion, create `.planning/phases/25-cross-platform-test-validation/25-02-SUMMARY.md`
</output>
